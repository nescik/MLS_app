{% extends "main/base.html" %}
{% load crispy_forms_tags %}

{% block title %}
    Twój profil
{% endblock title %}

{% block navbar %}
    {% include 'main/navbar.html' %}
{% endblock navbar %}


{% block content %}

<div class="container light-style flex-grow-1 container-p-y ">
    <h4 class="font-weight-bold py-3 mb-4">
        {% block title_profile %}
            Ustawienia konta - Ogólne
        {% endblock title_profile %}
    </h4>
    <div class="card overflow-hidden mb-5 profile-panel panel-shadow">
        <div class="row no-gutters">
            <div class="col-md-3 pt-0">
                <div class="list-group list-group-flush account-settings-links p-3 ">
                    <a class="list-group-item list-group-item-action " 
                        href="{% url 'account-general' %}">Ogólne</a>
                    <a class="list-group-item list-group-item-action" 
                        href="{% url 'account-change-password' %}">Zmień hasło</a>
                    <a class="list-group-item list-group-item-action" 
                        href="{% url 'account-info' %}">Informacje</a>
                    <a class="list-group-item list-group-item-action" 
                        href="{% url 'account-social' %}">Social media</a>
                </div>
            </div>
                <div class="col-md-9 profile-content">
                    {% block profile-content %}
                        <div class="tab-content">
                            {% block msg %}
                                {% if messages %}
                                    {% for message in messages  %}
                                        <div class="alert {% if message.tags == 'success' %}alert-success{% elif message.tags == 'warning' %}alert-danger{% endif %} m-3" role="alert">
                                            {{message}}
                                        </div>
                                    {% endfor %}
                                {% endif %}
                            {% endblock msg %}
                            <div class="tab-pane active show" id="account-general">
                                    <form method="POST" enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <div class="card-body media align-items-center">
                                            <img src="{{user.profile.image.url}}" alt class="d-block ui-w-80">
                                            <div class="media-body ml-4">
                                                {{form.image|as_crispy_field}}
                                            </div>
                                        </div>
                                        <hr class=" m-0">
                                        <div class="card-body">
                                        <div class="form-group">
                                            {{form.username|as_crispy_field}}
                                        </div>
                                        <div class="form-group">
                                            {{form.first_name|as_crispy_field}}
                                        </div>
                                        <div class="form-group">
                                            {{form.last_name|as_crispy_field}}
                                        </div>
                                        <div class="form-group">
                                            {{form.email|as_crispy_field}}
                                        </div>
                                        <button type="submit" class="btn btn-outline-light border-2 rounded-pill">Zapisz</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    {% endblock profile-content %}
                </div>
        </div>
    </div>
</div>



<script>
    $(document).ready(function () {
        // Pobieramy aktualny adres URL
        var currentUrl = window.location.href;

        // Iterujemy przez wszystkie linki w liście
        $('.account-settings-links a').each(function () {
            var linkUrl = $(this).attr('href');

            // Sprawdzamy, czy aktualny link odpowiada aktualnemu adresowi URL
            if (currentUrl.indexOf(linkUrl) !== -1) {
                // Dodajemy klasę active, jeśli link jest aktywny
                $(this).addClass('list-group-item-action active');
            }
        });
    });
</script>

{% endblock %}